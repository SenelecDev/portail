{% extends "base.html" %} 
{% block title %}{{ client.nom_complet }} - SENELEC{%endblock %} 
{% block content %}
<h2>DÃ©tails Client</h2>
<style>
  .EN_COURS {
    background: #fff3cd;
    border-left: 4px solid #ff9800;
    padding: 20px; margin: 15px 0; border-radius: 8px;
  }
  .RESOLUE {
    background: #e8f5e9;
    border-left: 4px solid #4caf50;
    padding: 20px; margin: 15px 0; border-radius: 8px;
  }
  .OUVERTE {
    background: #ffebee;
    border-left: 4px solid #f44336;
    padding: 20px; margin: 15px 0; border-radius: 8px;
  }

</style>
<div
  style="
    background: #f5f5f5;
    padding: 20px;
    border-radius: 8px;
    margin-bottom: 30px;
  "
  
>
  <h3>{{ client.nom_complet }}</h3>
  <p><strong>ğŸ“ Adresse :</strong> {{ client.adresse }}</p>
  <p><strong>ğŸ“ TÃ©lÃ©phone :</strong> {{ client.telephone }}</p>
  <p><strong>ğŸ“§ Email :</strong> {{ client.email|default:"Non renseignÃ©" }}</p>
  <p><strong>ğŸ”¢ NÂ° Compteur :</strong> {{ client.numero_compteur }}</p>
  <p><strong>ğŸ“‹ Type :</strong> {{ client.get_type_abonnement_display }}</p>
</div>
{% if is_admin %}
<h3>Factures ({{ factures.count }})</h3>
{% if factures %}
<table style="width: 100%; border-collapse: collapse">
  <thead style="background: #0d47a1; color: white">
    <tr>
      <th style="padding: 12px; text-align: left">NÂ° Facture</th>
      <th style="padding: 12px; text-align: left">PÃ©riode</th>
      <th style="padding: 12px; text-align: right">Montant</th>
      <th style="padding: 12px; text-align: center">Statut</th>
      <th style="padding: 12px; text-align: left">Ã‰chÃ©ance</th>
    </tr>
  </thead>
  <tbody>
    {% for facture in factures %}
    <tr style="border-bottom: 1px solid #ddd">
      <td style="padding: 12px">{{ facture.numero_facture }}</td>
      <td style="padding: 12px">{{ facture.periode }}</td>
      <td style="padding: 12px; text-align: right; font-weight: bold">
        {{ facture.montant }} FCFA
      </td>
      <td style="padding: 12px; text-align: center">
        {% if facture.statut == 'PAYEE' %}

        <span
          style="background: #4caf50; color: white; padding: 4px 12px; border-radius: 12px; font-
size: 0.9em;"
        >
          PayÃ©e
        </span>
        {% elif facture.statut == 'IMPAYEE' %}

        <span
          style="background: #f44336; color: white; padding: 4px 12px; border-radius: 12px; font-
size: 0.9em;"
        >
          ImpayÃ©e
        </span>
        {% else %}

        <span
          style="background: #ff9800; color: white; padding: 4px 12px; border-radius: 12px; font-
size: 0.9em;"
        >
          Partielle
        </span>
        {% endif %}
      </td>
      <td style="padding: 12px">{{ facture.date_echeance }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% else %}
<p style="color: #999; text-align: center; padding: 20px">
  Aucune facture pour ce client
</p>
{% endif %}


{% comment %} Liste des reclamations {% endcomment %}
<h3>Reclamations ({{ reclamations.count }})</h3>
{% if reclamations %} 
{% for reclamation in reclamations %}
<div
class="{{ reclamation.statut }}">
  <h3 style="margin-top: 0">ğŸ“{{ reclamation.sujet }}</h3>
  <p><strong>ğŸ“…Date :</strong> {{ reclamation.date_creation|date:"d/m/Y Ã  H:i" }}</p>
  <p><strong>ğŸ“Description :</strong> {{ reclamation.description }}</p>
  
    <!-- Ajouter l'affichage de la piÃ¨ce jointe -->
  {% if reclamation.piece_jointe %}
  <p style="margin: 10px 0;">
      <strong>ğŸ“ PiÃ¨ce jointe :</strong> 
      <a href="{{ reclamation.piece_jointe.url }}" target="_blank" style="color: #0d47a1;">
          TÃ©lÃ©charger le fichier
      </a>
  </p>
  {% endif %}


  <p><strong>ğŸ”§Statut :</strong> {{ reclamation.statut }}</p>
</div>
{% endfor %} 
{% else %}
<p
  style="
    text-align: center;
    color: #4caf50;
    padding: 40px;
    background: #e8f5e9;
    border-radius: 8px;
  "
>
  âœ… Aucune coupure programmÃ©e pour le moment
</p>
{% endif %} 
{% endif %}



<p style="margin-top: 20px">
  <a href="{% url 'liste_clients' %}" style="color: #0d47a1">â† Retour Ã  la liste</a>
</p>
{% endblock %}
